<div id="section-register" class="countrymeat-section">
  <section class="register-section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">

          <!-- BACK BUTTON -->
          <div class="back-btn-container mb-30">
            <button class="back-btn" (click)="goBack()">
              <i class="fa fa-arrow-left"></i> Back
            </button>
          </div>

          <div class="tptrack__product mt-40 mb-40">
            <div class="tptrack__content grey-bg p-30">

              <!-- REGISTRATION FORM -->
              <div *ngIf="!isOtpSent">
                <div class="tptrack__item d-flex mb-20">
                  <div class="tptrack__item-icon">
                    <i class="fa fa-user-plus"></i>
                  </div>
                  <div class="tptrack__item-content">
                    <h4 class="tptrack__item-title">New Account Registration</h4>
                    <p>Enter your details to create an account.</p>
                  </div>
                </div>

                <form (ngSubmit)="onRegisterSubmit()">
                  <div class="tptrack__input mb-20">
                    <div class="tpsign__input">
                      <span><i class="fa fa-user"></i></span>
                      <input
                        type="text"
                        placeholder="Full Name"
                        name="name"
                        [(ngModel)]="name"
                        required
                      />
                    </div>
                  </div>

                  <div class="tptrack__mobile mb-30">
                    <div class="tpsign__input">
                      <span><i class="fa fa-mobile"></i></span>
                      <input
                        type="text"
                        placeholder="Mobile Number"
                        name="mobile"
                        [(ngModel)]="mobile"
                        required
                        maxlength="10"
                        pattern="[0-9]*"
                      />
                    </div>
                  </div>

                  <div class="tptrack__btn mb-20">
                    <button
                      type="submit"
                      class="tptrack__submition tpsign__reg"
                      [disabled]="isLoading || mobile.length < 10 || !name"
                    >
                      <span *ngIf="isLoading">
                        <i class="fa fa-spinner fa-spin"></i> Sending OTP...
                      </span>
                      <span *ngIf="!isLoading">
                        Register & Send OTP 
                      </span>
                    </button>
                  </div>
                </form>

                <div class="text-center mt-20">
                  <p>
                    Already Registered? 
                    <a [routerLink]="['/login']" class="login-link">
                      Go to Login
                    </a>
                  </p>
                </div>

                <!-- SUCCESS / ERROR MESSAGE BELOW REGISTRATION -->
                <div *ngIf="message && !isOtpSent" class="message-box mt-20" [ngClass]="messageType">
                  {{ message }}
                </div>
              </div>

              <!-- OTP VERIFICATION -->
              <div *ngIf="isOtpSent">
                <div class="tptrack__item d-flex mb-20">
                  <div class="tptrack__item-icon icon-mobile">
                    <i class="fa fa-mobile"></i>
                  </div>
                  <div class="tptrack__item-content">
                    <h4 class="tptrack__item-title">Verify Mobile Number</h4>
                    <p>Enter the 6-digit OTP sent to <strong>{{ mobile }}</strong>.</p>
                  </div>
                </div>

                <form (ngSubmit)="onVerifyOtp()">
                  <div class="otp-container">
                    <div class="otp-inputs mb-30">
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 0)" [(ngModel)]="otp[0]" name="otp0" #otpInput required pattern="[0-9]*" />
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 1)" [(ngModel)]="otp[1]" name="otp1" #otpInput required pattern="[0-9]*" />
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 2)" [(ngModel)]="otp[2]" name="otp2" #otpInput required pattern="[0-9]*" />
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 3)" [(ngModel)]="otp[3]" name="otp3" #otpInput required pattern="[0-9]*" />
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 4)" [(ngModel)]="otp[4]" name="otp4" #otpInput required pattern="[0-9]*" />
                      <input type="text" maxlength="1" (keyup)="onDigitInput($event, 5)" [(ngModel)]="otp[5]" name="otp5" #otpInput required pattern="[0-9]*" />
                    </div>

                    <div class="tptrack__btn mb-20">
                      <button
                        type="submit"
                        class="tptrack__submition tpsign__reg"
                        [disabled]="isLoading || otp.join('').length < 6"
                      >
                        <span *ngIf="isLoading">
                          <i class="fa fa-spinner fa-spin"></i> Verifying...
                        </span>
                        <span *ngIf="!isLoading">
                          Complete Registration & Login 
                        </span>
                      </button>
                    </div>

                    <div class="text-center mb-20">
                      <span *ngIf="resendDisabled" class="cooldown-text">
                        Resend in ({{ cooldownTime }}s)
                      </span>
                      <a *ngIf="!resendDisabled" href="#" (click)="resendOtp($event)" class="resend-link">
                        Resend OTP
                      </a>
                    </div>

                    <div class="text-center">
                      <a href="#" (click)="goBackToDetails()">Change Details</a>
                    </div>
                  </div>
                </form>

                <!-- SUCCESS / ERROR MESSAGE BELOW OTP -->
                <div *ngIf="message && isOtpSent" class="message-box mt-20" [ngClass]="messageType">
                  {{ message }}
                </div>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>
  </section>
</div>

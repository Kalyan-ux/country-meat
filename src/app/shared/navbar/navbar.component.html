<nav class="navbar-modern" [class.search-active]="isMobileSearchActive">
  <div class="container-fluid">
    <!-- LEFT: Logo -->
    <div class="navbar-left">
      <div class="navbar-logo">
        <a routerLink="/">
          <img src="assets/LOGO_ori.png" alt="Country Meat Logo" />
        </a>
      </div>
    </div>

   <!-- LOCATION SECTION -->
<div class="navbar-location" (click)="toggleDropdown($event)">
  <i class="fa fa-map-marker location-icon"></i>

  <div class="location-details">
    <span class="location-city">
      Bangalore <i class="fa fa-chevron-down"></i>
    </span>
    <span class="location-address">Bengaluru, Karnataka</span>
  </div>
</div>

<!-- FULL SCREEN OVERLAY -->
<div 
  class="location-overlay" 
  *ngIf="dropdownOpen"
  (click)="closeDropdown()"
>
</div>

<!-- DROPDOWN MODAL -->
<div 
  class="location-modal" 
  *ngIf="dropdownOpen"
  (click)="stopClose($event)"
>
 <!-- Search & Current Location Combined -->
<div class="location-search-bar">

  <!-- Left side: Search icon + input -->
  <div class="search-left">
    <i class="fa fa-search"></i>
    <input type="text" placeholder="Search for your location" />
  </div>

  <!-- Right side: Use current location -->
  <button class="use-location-btn" (click)="useCurrentLocation()">
    <i class="fa fa-location-arrow"></i>
    Use current location
  </button>

</div>


  <!-- Saved Address -->
  <button class="saved-address-btn" (click)="goToSavedAddress()">
    <i class="fa fa-address-book"></i>
    Saved Address
  </button>
</div>


    <!-- SEARCH BAR -->
    <div class="navbar-search">
      <button class="close-search-btn" (click)="toggleMobileSearch()">
        <i class="fa fa-arrow-left"></i>
      </button>
      <div class="search-bar">
        <input
          type="text"
          class="search-input"
          placeholder="Search for products..."
        />
        <button class="search-button">
          <i class="fa fa-search"></i>
        </button>
      </div>
    </div>

    <!-- ACTION LINKS -->
    <div class="navbar-actions">
      <!-- CATEGORIES -->
      <div class="action-link-dropdown" #categoriesDropdown>
        <a class="action-link" (click)="toggleCategoriesDropdown($event)">
          <img
            src="assets/icon/categories.png"
            alt="Categories Icon"
            class="action-icon-img"
          />
          <span>Categories</span>
        </a>

        <div class="dropdown-menu" [class.show]="isCategoriesDropdownOpen">
          <a
            routerLink="/products/chicken"
            class="dropdown-item"
            (click)="isCategoriesDropdownOpen=false"
          >
            <img
              src="assets/images/products/ck/country-king-0.png"
              alt="Chicken"
              class="dropdown-item-icon"
            />
            <div class="dropdown-item-content">
              <span class="dropdown-item-title">Country Chicken</span>
              <span class="dropdown-item-desc">Premium quality chicken cuts</span>
            </div>
          </a>

          <a
            routerLink="/products/eggs"
            class="dropdown-item"
            (click)="isCategoriesDropdownOpen=false"
          >
            <img
              src="assets/images/products/eggs/egg-1.png"
              alt="Eggs"
              class="dropdown-item-icon"
            />
            <div class="dropdown-item-content">
              <span class="dropdown-item-title">Country Eggs</span>
              <span class="dropdown-item-desc">Farm-fresh eggs</span>
            </div>
          </a>

          <div class="dropdown-item coming-soon">
            <img
              src="assets/images/categories/mutton.jpg"
              alt="Mutton"
              class="dropdown-item-icon"
            />
            <div class="dropdown-item-content">
              <span class="dropdown-item-title">Mutton</span>
              <span class="dropdown-item-desc">Premium goat meat</span>
            </div>
            <span class="coming-soon-badge">Coming Soon</span>
          </div>

          <div class="dropdown-item coming-soon">
            <img
              src="assets/images/categories/sea-food.jpg"
              alt="Seafood"
              class="dropdown-item-icon"
            />
            <div class="dropdown-item-content">
              <span class="dropdown-item-title">Seafood</span>
              <span class="dropdown-item-desc">Daily catch from ocean</span>
            </div>
            <span class="coming-soon-badge">Coming Soon</span>
          </div>
        </div>
      </div>

      <!-- STORES LINK -->
      <a href="#" class="action-link">
        <img
          src="assets/icon/store.png"
          alt="Stores Icon"
          class="action-icon-img"
        />
        <span>Stores</span>
      </a>

      <!-- ðŸ‘¤ LOGIN / LOGGED-IN -->
      <ng-container *ngIf="!isLoggedIn; else loggedInUser">
        <a routerLink="/login" class="action-link user-btn">
          <img
            src="assets/icon/user.png"
            alt="User Icon"
            class="action-icon-img"
          />
          <span>Login</span>
        </a>
      </ng-container>

      <!-- âœ… LOGGED-IN USER -->
      <ng-template #loggedInUser>
        <div class="navbar-user user-btn" (click)="toggleSidebar()">
          <img
            src="assets/icon/user.png"
            alt="User Icon"
            class="navbar-user-icon"
          />
          <span class="user-name" [title]="userName">
            {{ userName.length > 8 ? (userName | slice: 0:8) + 'â€¦' : userName }}
          </span>
        </div>
      </ng-template>

      <a routerLink="/about" class="action-link" routerLinkActive="active">
        About Us
      </a>
    </div>
    

    <!-- CART -->
    <div class="navbar-cart">
      <a routerLink="/cart" class="cart-button">
        <div class="cart-icon-wrapper">
          <i class="fa fa-shopping-cart"></i>
        </div>
        <div class="cart-details">
          <span class="cart-items">1 item</span>
          <span class="cart-price">â‚¹199</span>
        </div>
      </a>
    </div>
  </div>
</nav>




<!-- âœ… SIDEBAR BACKDROP -->
<div class="sidebar-backdrop" *ngIf="isSidebarOpen" (click)="toggleSidebar()"></div>

<!-- âœ… RIGHT SLIDER (Sidebar) -->
<div class="user-sidebar" #userSidebar [class.open]="isSidebarOpen">
  <!-- Sidebar Header with Logo -->
  <div class="sidebar-logo">
    <img src="assets/LOGO_ori.png" alt="Sidebar Logo" />
  </div>

  <div class="sidebar-user-info">
    <img src="assets/icon/profile.png" alt="User Icon" class="user-icon-img" />
    <div class="user-details">
      <h3>{{ userName }}</h3>
      <p *ngIf="userPhone">+91 {{ userPhone }}</p>
    </div>
  </div>

  <ul class="sidebar-menu">
    <li (click)="router.navigate(['/about']); toggleSidebar()">
  <i class="fa fa-info-circle"></i> About
</li>

    <li (click)="router.navigate(['/rewards']); toggleSidebar()">
  <i class="fa fa-trophy"></i> Rewards
  <!-- <small class="wallet-info">Complete milestone and win exciting rewards </small> -->
</li>

    <li (click)="router.navigate(['/order-confirmation']); toggleSidebar()">
      <i class="fa fa-shopping-bag"></i> Orders
    </li>
    <li (click)="navigateTo('/address')">
  <i class="fa fa-map-marker-alt"></i> Addresses
</li>
<li (click)="router.navigate(['/wallet']); toggleSidebar()">
  <i class="fa fa-wallet"></i> Country Meat Wallet
</li>
<li (click)="router.navigate(['/refer-friend']); toggleSidebar()">
  <i class="fa fa-gift"></i> Refer a Friend
</li>


    <li (click)="router.navigate(['/terms-and-conditions']); toggleSidebar()">
      <i class="fa fa-file-contract"></i> Terms & Conditions
    </li>
    <li (click)="router.navigate(['/faq']); toggleSidebar()">
      <i class="fa fa-question-circle"></i> FAQ
    </li>
    <li (click)="router.navigate(['/privacy-policy']); toggleSidebar()">
      <i class="fa fa-shield-alt"></i> Privacy Policy
    </li>
    <li class="logout" (click)="logout()">
      <i class="fa fa-sign-out-alt"></i> Logout
    </li>
  </ul>
</div>
<!-- âœ… MOBILE-ONLY NAVBAR -->
<div class="mobile-navbar">
  <div class="mobile-top">
    
    <!-- LEFT: Delivery To -->
   <!-- MOBILE NAV LEFT: Delivery To -->
<div class="mobile-left mobile-only" (click)="toggleLeftDropdown($event)">
  <i class="fa fa-map-marker location-icon"></i>

  <div class="mobile-text">
    <span class="delivery-title">Delivery to</span>
    <p class="delivery-address">{{ selectedAddress }}</p>
  </div>

  <!-- MOBILE DROPDOWN -->
  <div class="address-dropdown" *ngIf="leftDropdownOpen">
    <button class="dropdown-option" (click)="useCurrentLocationLeft($event)">
      <i class="fa fa-location-arrow"></i>
      Use current location
    </button>

    <button class="dropdown-option" (click)="goToSavedAddressLeft($event)">
      <i class="fa fa-map"></i>
      Saved address
    </button>
  </div>
</div>


    <!-- CENTER: Logo -->
    <div class="mobile-center">
      <img src="assets/LOGO_ori.png" class="mobile-logo" />
    </div>

    <!-- RIGHT: Delivery Day -->
    <div class="mobile-right">
<img src="assets/icon/delivery_1.png" alt="Delivery" class="mobile-icon" />

      <div class="mobile-text">
        <span class="delivery-title">Delivery on</span>
        <p class="delivery-day">Sundayâ€™s</p>
      </div>
    </div>
  </div>
   <!-- MOBILE SEARCH BAR -->
<div class="mobile-search">
    <i class="fa fa-search search-icon"></i>
    <input type="text" placeholder="Search for meats and products..." />
  </div>
</div>


    

<!-- âœ… BOTTOM NAV -->
<div class="bottom-nav">
  <a routerLink="/" class="bottom-nav-link">
    <i class="fa fa-home"></i>
    <span>Home</span>
  </a>

<a class="bottom-nav-link" (click)="openCategoriesBottomSheet($event)">

  <img
    src="assets/icon/categories.png"
    alt="Categories Icon"
    class="bottom-user-icon"
  />
  <span>Categories</span>
</a>
<!-- â­ MOBILE CATEGORY BOTTOM SHEET -->
<div class="category-bottom-sheet-overlay" *ngIf="showCategoriesSheet" (click)="closeCategoriesBottomSheet()"></div>

<div class="category-bottom-sheet" *ngIf="showCategoriesSheet">
  <div class="sheet-header">
    <h3>Categories</h3>
    <button class="close-btn" (click)="closeCategoriesBottomSheet()">
      <i class="fa fa-times"></i>
    </button>
  </div>

  <div class="sheet-content">

    <a routerLink="/products/chicken" class="sheet-item" (click)="closeCategoriesBottomSheet()">
      <img src="assets/images/products/ck/country-king-0.png" />
      <span>Country Chicken</span>
    </a>

    <a routerLink="/products/eggs" class="sheet-item" (click)="closeCategoriesBottomSheet()">
      <img src="assets/images/products/eggs/egg-1.png" />
      <span>Country Eggs</span>
    </a>

    <div class="sheet-item coming-soon">
      <img src="assets/images/categories/mutton.jpg" />
     <span>
  Mutton <span class="coming-soon-text">(Coming soon)</span>
</span>

    </div>

    <div class="sheet-item coming-soon">
      <img src="assets/images/categories/sea-food.jpg" />
      <span>
  Sea Food <span class="coming-soon-text">(Coming soon)</span>
</span>

    </div>

  </div>
</div>

  <!-- <a class="bottom-nav-link" (click)="toggleMobileSearch()">
    <i class="fa fa-search"></i>
    <span>Search</span>
  </a> -->

  <!-- ACCOUNT SECTION -->
  <ng-container *ngIf="!isLoggedIn; else bottomLoggedIn">
    <a routerLink="/login" class="bottom-nav-link user-btn">
      <img
        src="assets/icon/user.png"
        alt="Account Icon"
        class="bottom-user-icon"
      />
      <span>Account</span>
    </a>
  </ng-container>

  <ng-template #bottomLoggedIn>
    <a class="bottom-nav-link user-btn" (click)="toggleSidebar()">
      <img
        src="assets/icon/user.png"
        alt="User Icon"
        class="bottom-user-icon"
      />
      <span>{{ userName.length > 8 ? (userName | slice: 0:8) + 'â€¦' : userName }}</span>
    </a>
  </ng-template>

  <a routerLink="/cart" class="bottom-nav-link">
    <i class="fa fa-shopping-cart"></i>
    <span>Cart</span>
  </a>
</div>
<!-- âœ… Logout Confirmation Popup -->
<div class="logout-modal-backdrop" *ngIf="showLogoutConfirm">
  <div class="logout-modal">
    <h2>Logout ?</h2>
    <p>Are you sure you want to logout !</p>
    <div class="logout-buttons">
      <button class="yes-btn" (click)="confirmLogout()">Yes</button>
      <button class="cancel-btn" (click)="cancelLogout()">Cancel</button>
    </div>
  </div>

</div>
